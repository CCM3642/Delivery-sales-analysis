<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Crispy Chicken Multi-Branch Data Analysis Dashboard</title>
    
    <!-- Bootstrap 5 CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Chart.js -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Custom CSS -->
    <style>
        :root {
            --primary-color: #ff6b35;
            --secondary-color: #f7931e;
            --dark-color: #212529;
            --light-color: #f8f9fa;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --info-color: #17a2b8;
        }
        
        body {
            background-color: #f5f5f5;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .navbar {
            background-color: var(--primary-color) !important;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .nav-tabs .nav-link {
            color: var(--dark-color);
            border: none;
            border-bottom: 3px solid transparent;
            padding: 0.75rem 1.5rem;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .nav-tabs .nav-link.active {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
            background-color: transparent;
        }
        
        .nav-tabs .nav-link:hover {
            color: var(--primary-color);
            border-bottom: 3px solid var(--primary-color);
        }
        
        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        
        .card:hover {
            transform: translateY(-5px);
        }
        
        .metric-card {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 10px;
            padding: 1.5rem;
            margin-bottom: 1rem;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }
        
        .metric-value {
            font-size: 2rem;
            font-weight: bold;
        }
        
        .metric-label {
            font-size: 0.9rem;
            opacity: 0.9;
        }
        
        .chart-container {
            position: relative;
            height: 400px;
            margin-bottom: 2rem;
        }
        
        .table-responsive {
            border-radius: 10px;
            overflow: hidden;
        }
        
        .table {
            margin-bottom: 0;
        }
        
        .table thead th {
            background-color: var(--primary-color);
            color: white;
            border: none;
        }
        
        .btn-primary {
            background-color: var(--primary-color);
            border-color: var(--primary-color);
        }
        
        .btn-primary:hover {
            background-color: var(--secondary-color);
            border-color: var(--secondary-color);
        }
        
        .form-control:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(255, 107, 53, 0.25);
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1050;
            min-width: 300px;
        }
        
        .loading-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 255, 255, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999;
        }
        
        .spinner-border {
            width: 3rem;
            height: 3rem;
            border-width: 0.3em;
        }
        
        .tab-content {
            padding: 1.5rem 0;
        }
        
        .branch-badge {
            background-color: var(--secondary-color);
            color: white;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
        }
        
        .offer-normal {
            background-color: var(--success-color);
        }
        
        .offer-chicken {
            background-color: var(--warning-color);
        }
        
        .offer-ultimate {
            background-color: var(--danger-color);
        }
        
        .page-header {
            margin-bottom: 2rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid #e0e0e0;
        }
        
        .page-header h1 {
            color: var(--dark-color);
            font-weight: 600;
        }
        
        .page-header .breadcrumb {
            margin-bottom: 0;
            padding: 0;
            background-color: transparent;
        }
        
        .page-header .breadcrumb-item a {
            color: var(--primary-color);
            text-decoration: none;
        }
        
        .page-header .breadcrumb-item.active {
            color: var(--dark-color);
        }
        
        .save-status {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 500;
            margin-left: 10px;
        }
        
        .save-saved {
            background-color: var(--success-color);
            color: white;
        }
        
        .save-unsaved {
            background-color: var(--warning-color);
            color: darkslategray;
        }
        
        .save-saving {
            background-color: var(--primary-color);
            color: white;
        }
        
        .data-management-card {
            background-color: #f8f9fa;
            border-left: 4px solid var(--primary-color);
            padding: 1rem;
            margin-bottom: 1rem;
            border-radius: 5px;
        }
        
        .auto-save-toggle {
            display: flex;
            align-items: center;
            margin-bottom: 1rem;
        }
        
        .auto-save-toggle .form-check-input {
            margin-right: 0.5rem;
        }
        
        .data-stats {
            display: flex;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding: 0.75rem;
            background-color: #e9ecef;
            border-radius: 5px;
        }
        
        .data-stats .stat-item {
            text-align: center;
        }
        
        .data-stats .stat-value {
            font-size: 1.5rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .data-stats .stat-label {
            font-size: 0.85rem;
            color: #6c757d;
        }
        
        .last-saved {
            font-size: 0.85rem;
            color: #6c757d;
            margin-bottom: 1rem;
        }
        
        .btn-group .btn {
            border-radius: 0;
        }
        
        .btn-group .btn:first-child {
            border-top-left-radius: 5px;
            border-bottom-left-radius: 5px;
        }
        
        .btn-group .btn:last-child {
            border-top-right-radius: 5px;
            border-bottom-right-radius: 5px;
        }
        
        .form-text {
            font-size: 0.875rem;
            color: #6c757d;
            margin-top: 0.25rem;
        }
        
        .invalid-feedback {
            display: block;
            width: 100%;
            margin-top: 0.25rem;
            font-size: 0.875rem;
            color: var(--danger-color);
        }
        
        .alert {
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        .alert-dismissible .btn-close {
            padding: 0.25rem 0.5rem;
        }
        
        .chart-legend {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            margin-top: 1rem;
        }
        
        .chart-legend-item {
            display: flex;
            align-items: center;
            margin: 0 1rem 0.5rem 0;
        }
        
        .chart-legend-color {
            width: 12px;
            height: 12px;
            border-radius: 2px;
            margin-right: 0.5rem;
        }
        
        .data-card {
            transition: all 0.3s ease;
        }
        
        .data-card:hover {
            box-shadow: 0 8px 16px rgba(0,0,0,0.15);
        }
        
        .performance-indicator {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 600;
            margin-left: 0.5rem;
        }
        
        .performance-high {
            background-color: var(--success-color);
            color: white;
        }
        
        .performance-medium {
            background-color: var(--warning-color);
            color: darkslategray;
        }
        
        .performance-low {
            background-color: var(--danger-color);
            color: white;
        }
        
        .table th {
            white-space: nowrap;
        }
        
        .table td {
            vertical-align: middle;
        }
        
        /* Custom styles for data entry form */
        .data-entry-section {
            margin-bottom: 2rem;
        }
        
        .data-entry-section h5 {
            color: var(--primary-color);
            margin-bottom: 1rem;
        }
        
        /* Modal styles */
        .modal-header {
            background-color: var(--primary-color);
            color: white;
        }
        
        .modal-header .btn-close {
            filter: brightness(0) invert(1);
        }
        
        /* Chart container responsive */
        @media (max-width: 768px) {
            .chart-container {
                height: 300px;
            }
            
            .metric-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg navbar-dark">
        <div class="container-fluid">
            <a class="navbar-brand" href="#"><i class="fas fa-chicken-drumstick"></i> Crispy Chicken Analysis Dashboard</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('dashboard')"><i class="fas fa-chart-line"></i> Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('data-entry')"><i class="fas fa-plus-circle"></i> Data Entry</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#" onclick="showPage('management-report')"><i class="fas fa-file-alt"></i> Management Report</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <div class="container-fluid mt-4">
        <!-- Dashboard Page -->
        <div id="dashboard-page" class="page-content">
            <div class="page-header">
                <h1>Sales Data Analysis Dashboard</h1>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item active">Dashboard</li>
                    </ol>
                </nav>
            </div>

            <!-- Date Range Selector -->
            <div class="card mb-4">
                <div class="card-body">
                    <div class="row align-items-center">
                        <div class="col-md-4">
                            <label for="dateRange" class="form-label">Date Range</label>
                            <div class="input-group">
                                <input type="date" id="startDate" class="form-control" value="2025-10-01">
                                <span class="input-group-text">to</span>
                                <input type="date" id="endDate" class="form-control" value="2025-10-14">
                                <button class="btn btn-primary" onclick="updateDashboard()"><i class="fas fa-sync"></i> Update</button>
                            </div>
                            <div class="form-text">Select the date range for analysis</div>
                        </div>
                        <div class="col-md-4">
                            <label for="branchFilter" class="form-label">Branch Filter</label>
                            <select id="branchFilter" class="form-select" onchange="updateDashboard()">
                                <option value="all">All Branches</option>
                                <option value="Crispy Chicken-Hamdan St">Crispy Chicken-Hamdan St</option>
                                <option value="Crispy Chicken Khaldia">Crispy Chicken Khaldia</option>
                                <option value="Crispy Chicken Shabiya 11">Crispy Chicken Shabiya 11</option>
                                <option value="Crispy Chicken Muroor">Crispy Chicken Muroor</option>
                                <option value="Crispy Chicken Al Barsha">Crispy Chicken Al Barsha</option>
                                <option value="Crispy Chicken Al Satwa">Crispy Chicken Al Satwa</option>
                                <option value="Crispy Chicken Al Rgga">Crispy Chicken Al Rgga</option>
                            </select>
                        </div>
                        <div class="col-md-4">
                            <label for="offerFilter" class="form-label">Offer Filter</label>
                            <select id="offerFilter" class="form-select" onchange="updateDashboard()">
                                <option value="all">All Offers</option>
                                <option value="Normal Day">Normal Day</option>
                                <option value="Chicken Day">Chicken Day</option>
                                <option value="Ultimate">Ultimate</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Key Metrics -->
            <div class="row mb-4">
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-value" id="totalSales">0</div>
                        <div class="metric-label">Total Sales (AED)</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-value" id="totalTransactions">0</div>
                        <div class="metric-label">Total Transactions</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-value" id="avgTransaction">0</div>
                        <div class="metric-label">Avg. Transaction (AED)</div>
                    </div>
                </div>
                <div class="col-md-3">
                    <div class="metric-card">
                        <div class="metric-value" id="targetAchievement">0%</div>
                        <div class="metric-label">Target Achievement</div>
                    </div>
                </div>
            </div>

            <!-- Tabs for different views -->
            <ul class="nav nav-tabs" id="dashboardTabs" role="tablist">
                <li class="nav-item" role="presentation">
                    <button class="nav-link active" id="overview-tab" data-bs-toggle="tab" data-bs-target="#overview" type="button" role="tab">Overview</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="performance-tab" data-bs-toggle="tab" data-bs-target="#performance" type="button" role="tab">Performance</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="trends-tab" data-bs-toggle="tab" data-bs-target="#trends" type="button" role="tab">Trends</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="insights-tab" data-bs-toggle="tab" data-bs-target="#insights" type="button" role="tab">Insights</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="recommendations-tab" data-bs-toggle="tab" data-bs-target="#recommendations" type="button" role="tab">Recommendations</button>
                </li>
                <li class="nav-item" role="presentation">
                    <button class="nav-link" id="offers-tab" data-bs-toggle="tab" data-bs-target="#offers" type="button" role="tab">Offers</button>
                </li>
            </ul>

            <div class="tab-content" id="dashboardTabsContent">
                <!-- Overview Tab -->
                <div class="tab-pane fade show active" id="overview" role="tabpanel">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Sales & Transactions Trend</h5>
                                </div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="salesTrendChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Branch Sales Distribution</h5>
                                </div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="branchSalesChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-4">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Daily Sales Details</h5>
                                </div>
                                <div class="card-body">
                                    <div class="table-responsive">
                                        <table class="table table-hover">
                                            <thead>
                                                <tr>
                                                    <th>Date</th>
                                                    <th>Branch</th>
                                                    <th>Channel</th>
                                                    <th>Transactions</th>
                                                    <th>Sales (AED)</th>
                                                    <th>Average per Order</th>
                                                    <th>Offer Type</th>
                                                    <th>Offer Status</th>
                                                </tr>
                                            </thead>
                                            <tbody id="dailySalesTable">
                                                <!-- Table content will be populated by JavaScript -->
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Performance Tab -->
                <div class="tab-pane fade" id="performance" role="tabpanel">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Branch Performance Radar</h5>
                                </div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="branchPerformanceRadarChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Branch Performance Ranking</h5>
                                </div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="branchPerformanceRankingChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-4">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Performance Metrics</h5>
                                </div>
                                <div class="card-body">
                                    <div class="row">
                                        <div class="col-md-4">
                                            <div class="text-center">
                                                <h3>Best Branch</h3>
                                                <div class="branch-badge" id="bestBranch">-</div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="text-center">
                                                <h3>Highest Transactions</h3>
                                                <div class="branch-badge" id="highestTransactionsBranch">-</div>
                                            </div>
                                        </div>
                                        <div class="col-md-4">
                                            <div class="text-center">
                                                <h3>Highest Avg. Sale</h3>
                                                <div class="branch-badge" id="highestAvgSaleBranch">-</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Trends Tab -->
                <div class="tab-pane fade" id="trends" role="tabpanel">
                    <div class="row">
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Daily Trends</h5>
                                </div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="dailyTrendsChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Weekly Trends</h5>
                                </div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="weeklyTrendsChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="row mt-4">
                        <div class="col-md-12">
                            <div class="card">
                                <div class="card-header">
                                    <h5 class="mb-0">Moving Average Analysis</h5>
                                </div>
                                <div class="card-body">
                                    <div class="chart-container">
                                        <canvas id="movingAverageChart"></canvas>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Insights Tab -->
                <div class="tab-pane fade" id="insights" role="tabpanel">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">AI Insights Analysis</h5>
                        </div>
                        <div class="card-body">
                            <div class="row">
                                <div class="col-md-6">
                                    <h6>Anomaly Detection</h6>
                                    <div id="anomalyDetection">
                                        <div class="alert alert-warning">
                                            <i class="fas fa-exclamation-triangle"></i> 
                                            <strong>Anomaly Detection:</strong> 
                                            <p id="anomalyText">Analyzing data...</p>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-6">
                                    <h6>Predictive Analytics</h6>
                                    <div id="predictiveAnalytics">
                                        <div class="alert alert-info">
                                            <i class="fas fa-chart-line"></i> 
                                            <strong>Sales Prediction:</strong> 
                                            <p id="predictionText">Generating prediction...</p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row mt-4">
                                <div class="col-md-12">
                                    <h6>Key Findings</h6>
                                    <div id="keyFindings">
                                        <ul class="list-group" id="keyFindingsList">
                                            <!-- Key findings will be populated by JavaScript -->
                                        </ul>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Recommendations Tab -->
                <div class="tab-pane fade" id="recommendations" role="tabpanel">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">30-Day Action Plan</h5>
                        </div>
                        <div class="card-body">
                            <div class="accordion" id="recommendationsAccordion">
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#recommendations1">
                                            Short-term Actions
                                        </button>
                                    </h2>
                                    <div id="recommendations1" class="accordion-collapse collapse show" data-bs-parent="#recommendationsAccordion">
                                        <div class="accordion-body">
                                            <ul>
                                                <li>Increase weekend promotions at Hamdan St branch to handle high traffic</li>
                                                <li>Introduce more family meal packages at Al Barsha branch to increase average transaction value</li>
                                                <li>Optimize Muroor branch operating hours to match customer demand patterns</li>
                                                <li>Add new product sampling activities at Khaldia branch to attract more customers</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#recommendations2">
                                            Medium-term Strategy Adjustments
                                        </button>
                                    </h2>
                                    <div id="recommendations2" class="accordion-collapse collapse" data-bs-parent="#recommendationsAccordion">
                                        <div class="accordion-body">
                                            <ul>
                                                <li>Redistribute target sales indicators for each branch based on sales data</li>
                                                <li>Create specific improvement plans for underperforming branches</li>
                                                <li>Analyze ROI of different offer types and optimize promotion strategy</li>
                                                <li>Evaluate new branch location possibilities to expand market coverage</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                                <div class="accordion-item">
                                    <h2 class="accordion-header">
                                        <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#recommendations3">
                                            Long-term Development Plans
                                        </button>
                                    </h2>
                                    <div id="recommendations3" class="accordion-collapse collapse" data-bs-parent="#recommendationsAccordion">
                                        <div class="accordion-body">
                                            <ul>
                                                <li>Develop customer loyalty program to increase retention rate</li>
                                                <li>Consider launching online ordering and delivery services</li>
                                                <li>Explore new product lines to increase revenue sources</li>
                                                <li>Develop brand expansion plan to enter new market areas</li>
                                            </ul>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Offers Tab -->
                <div class="tab-pane fade" id="offers" role="tabpanel">
                    <div class="card">
                        <div class="card-header d-flex justify-content-between align-items-center">
                            <h5 class="mb-0">Offer Management System</h5>
                            <button class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#addOfferModal">
                                <i class="fas fa-plus"></i> Add Offer
                            </button>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Offer Name</th>
                                            <th>Type</th>
                                            <th>Discount</th>
                                            <th>Start Date</th>
                                            <th>End Date</th>
                                            <th>Status</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="offersTable">
                                        <!-- Offers will be populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Data Entry Page -->
        <div id="data-entry-page" class="page-content" style="display: none;">
            <div class="page-header">
                <h1>Data Entry</h1>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item active">Data Entry</li>
                    </ol>
                </nav>
            </div>

            <!-- Data Management Section -->
            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Data Management</h5>
                </div>
                <div class="card-body">
                    <div class="data-management-card">
                        <div class="auto-save-toggle">
                            <div class="form-check form-switch">
                                <input class="form-check-input" type="checkbox" id="autoSaveToggle" checked>
                                <label class="form-check-label" for="autoSaveToggle">
                                    Auto-save enabled
                                </label>
                            </div>
                            <span id="saveStatus" class="save-status save-saved">Saved</span>
                        </div>
                        
                        <div class="last-saved">
                            Last saved: <span id="lastSavedTime">Never</span>
                        </div>
                        
                        <div class="data-stats">
                            <div class="stat-item">
                                <div class="stat-value" id="salesRecordsCount">0</div>
                                <div class="stat-label">Sales Records</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="offersCount">0</div>
                                <div class="stat-label">Offers</div>
                            </div>
                            <div class="stat-item">
                                <div class="stat-value" id="totalDataSize">0 KB</div>
                                <div class="stat-label">Data Size</div>
                            </div>
                        </div>
                        
                        <div class="btn-group w-100 mb-3" role="group">
                            <button type="button" class="btn btn-outline-primary" onclick="saveData()">
                                <i class="fas fa-save"></i> Save Data
                            </button>
                            <button type="button" class="btn btn-outline-success" onclick="exportData()">
                                <i class="fas fa-download"></i> Export Backup
                            </button>
                            <button type="button" class="btn btn-outline-info" onclick="importData()">
                                <i class="fas fa-upload"></i> Import Backup
                            </button>
                            <button type="button" class="btn btn-outline-warning" onclick="clearAllData()">
                                <i class="fas fa-trash-alt"></i> Clear All Data
                            </button>
                            <button type="button" class="btn btn-outline-secondary" onclick="resetToSample()">
                                <i class="fas fa-undo"></i> Reset to Sample
                            </button>
                        </div>
                        
                        <input type="file" id="importFile" class="d-none" accept=".json">
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Add New Sales Data</h5>
                        </div>
                        <div class="card-body">
                            <form id="salesDataForm">
                                <div class="row">
                                    <div class="col-md-3 mb-3">
                                        <label for="dateInput" class="form-label">Date</label>
                                        <input type="date" class="form-control" id="dateInput" required>
                                        <div class="invalid-feedback" id="dateInputFeedback"></div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label for="branchInput" class="form-label">Branch</label>
                                        <select class="form-select" id="branchInput" required>
                                            <option value="">Select Branch</option>
                                            <option value="Crispy Chicken-Hamdan St">Crispy Chicken-Hamdan St</option>
                                            <option value="Crispy Chicken Khaldia">Crispy Chicken Khaldia</option>
                                            <option value="Crispy Chicken Shabiya 11">Crispy Chicken Shabiya 11</option>
                                            <option value="Crispy Chicken Muroor">Crispy Chicken Muroor</option>
                                            <option value="Crispy Chicken Al Barsha">Crispy Chicken Al Barsha</option>
                                            <option value="Crispy Chicken Al Satwa">Crispy Chicken Al Satwa</option>
                                            <option value="Crispy Chicken Al Rgga">Crispy Chicken Al Rgga</option>
                                        </select>
                                        <div class="invalid-feedback" id="branchInputFeedback"></div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label for="channelInput" class="form-label">Channel</label>
                                        <select class="form-select" id="channelInput" required>
                                            <option value="">Select Channel</option>
                                            <option value="Delivery">Delivery</option>
                                            <option value="Dine-in">Dine-in</option>
                                            <option value="Takeaway">Takeaway</option>
                                        </select>
                                        <div class="invalid-feedback" id="channelInputFeedback"></div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label for="transactionsInput" class="form-label">Transactions</label>
                                        <input type="number" class="form-control" id="transactionsInput" min="0" required>
                                        <div class="form-text">Enter the number of transactions</div>
                                        <div class="invalid-feedback" id="transactionsInputFeedback"></div>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-3 mb-3">
                                        <label for="salesInput" class="form-label">Sales (AED)</label>
                                        <input type="number" class="form-control" id="salesInput" min="0" step="0.01" required>
                                        <div class="form-text">Enter the total sales amount in AED</div>
                                        <div class="invalid-feedback" id="salesInputFeedback"></div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label for="averageInput" class="form-label">Average per Order</label>
                                        <input type="number" class="form-control" id="averageInput" min="0" step="0.01" readonly>
                                        <div class="form-text">Calculated automatically</div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label for="offerTypeInput" class="form-label">Offer Type</label>
                                        <select class="form-select" id="offerTypeInput" required>
                                            <option value="">Select Offer Type</option>
                                            <option value="Normal Day">Normal Day</option>
                                            <option value="Chicken Day">Chicken Day</option>
                                            <option value="Ultimate">Ultimate</option>
                                        </select>
                                        <div class="invalid-feedback" id="offerTypeInputFeedback"></div>
                                    </div>
                                    <div class="col-md-3 mb-3">
                                        <label for="offerStatusInput" class="form-label">Offer Status</label>
                                        <select class="form-select" id="offerStatusInput" required>
                                            <option value="">Select Status</option>
                                            <option value="Active">Active</option>
                                            <option value="No Offer">No Offer</option>
                                        </select>
                                        <div class="invalid-feedback" id="offerStatusInputFeedback"></div>
                                    </div>
                                </div>
                                
                                <div class="row">
                                    <div class="col-md-12 mb-3">
                                        <label for="notesInput" class="form-label">Notes</label>
                                        <textarea class="form-control" id="notesInput" rows="2" placeholder="Additional notes (optional)"></textarea>
                                    </div>
                                </div>
                                
                                <button type="submit" class="btn btn-primary w-100">
                                    <i class="fas fa-save"></i> Save Data
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-md-12">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Data Records</h5>
                        </div>
                        <div class="card-body">
                            <div class="table-responsive">
                                <table class="table table-hover">
                                    <thead>
                                        <tr>
                                            <th>Date</th>
                                            <th>Branch</th>
                                            <th>Channel</th>
                                            <th>Transactions</th>
                                            <th>Sales (AED)</th>
                                            <th>Average per Order</th>
                                            <th>Offer Type</th>
                                            <th>Offer Status</th>
                                            <th>Notes</th>
                                            <th>Actions</th>
                                        </tr>
                                    </thead>
                                    <tbody id="dataTable">
                                        <!-- Table content will be populated by JavaScript -->
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Management Report Page -->
        <div id="management-report-page" class="page-content" style="display: none;">
            <div class="page-header">
                <h1>Management Report</h1>
                <nav aria-label="breadcrumb">
                    <ol class="breadcrumb">
                        <li class="breadcrumb-item"><a href="#">Home</a></li>
                        <li class="breadcrumb-item active">Management Report</li>
                    </ol>
                </nav>
            </div>

            <div class="card mb-4">
                <div class="card-header">
                    <h5 class="mb-0">Executive Summary</h5>
                </div>
                <div class="card-body">
                    <p>This report analyzes Crispy Chicken's sales data from October 1-14, 2025. During this period, the company achieved total sales of <span id="reportTotalSales">0</span> AED with <span id="reportTotalTransactions">0</span> transactions completed. The average transaction value was <span id="reportAvgTransaction">0</span> AED. Overall, the company performed well during this period, with particularly strong performance from the Hamdan St and Khaldia branches.</p>
                    <p>During the reporting period, we observed that weekend sales were significantly higher than weekdays, indicating that our marketing activities are more effective on weekends. Additionally, the Ultimate offer type had the highest conversion rate, suggesting we should promote more of these offers in the future.</p>
                </div>
            </div>

            <div class="row">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Branch Performance Analysis</h5>
                        </div>
                        <div class="card-body">
                            <div class="chart-container" style="height: 300px;">
                                <canvas id="branchPerformanceChart"></canvas>
                            </div>
                            <div class="mt-3">
                                <h6>Key Findings:</h6>
                                <ul>
                                    <li>Hamdan St branch has the highest sales, accounting for 35% of total sales</li>
                                    <li>Al Barsha branch has fewer transactions but the highest average transaction value</li>
                                    <li>Al Satwa branch performs particularly well on weekends but relatively weak on weekdays</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Daily & Weekly Performance</h5>
                        </div>
                        <div class="card-body">
                            <div class="chart-container" style="height: 300px;">
                                <canvas id="dailyWeeklyPerformanceChart"></canvas>
                            </div>
                            <div class="mt-3">
                                <h6>Key Findings:</h6>
                                <ul>
                                    <li>Saturday and Sunday are peak sales days, with 40% higher transaction volume than weekdays</li>
                                    <li>Week 1 (Oct 1-7) had slightly higher sales than Week 2</li>
                                    <li>Wednesday is typically the lowest transaction day of the week</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row mt-4">
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Monthly Trend Analysis</h5>
                        </div>
                        <div class="card-body">
                            <div class="chart-container" style="height: 300px;">
                                <canvas id="monthlyTrendChart"></canvas>
                            </div>
                            <div class="mt-3">
                                <h6>Key Findings:</h6>
                                <ul>
                                    <li>Beginning and end of month typically show better sales performance</li>
                                    <li>Middle of month has higher sales volatility, requiring further analysis</li>
                                    <li>Overall sales show an upward trend with 12% month-over-month growth</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-md-6">
                    <div class="card">
                        <div class="card-header">
                            <h5 class="mb-0">Target Distribution Plan</h5>
                        </div>
                        <div class="card-body">
                            <div class="chart-container" style="height: 300px;">
                                <canvas id="targetPlanChart"></canvas>
                            </div>
                            <div class="mt-3">
                                <h6>Target Distribution Recommendations:</h6>
                                <ul>
                                    <li>Hamdan St branch: 35% target share (based on historical performance)</li>
                                    <li>Khaldia branch: 25% target share (based on traffic analysis)</li>
                                    <li>Al Barsha branch: 20% target share (based on average transaction value)</li>
                                    <li>Other branches: 20% target share (based on growth potential)</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="card mt-4">
                <div class="card-header">
                    <h5 class="mb-0">Management Recommendations</h5>
                </div>
                <div class="card-body">
                    <div class="row">
                        <div class="col-md-4">
                            <h6>Short-term Recommendations</h6>
                            <ul>
                                <li>Increase weekend promotional activities</li>
                                <li>Optimize non-peak hour marketing at Al Satwa branch</li>
                                <li>Launch premium meal packages at Al Barsha branch</li>
                                <li>Strengthen membership program at Khaldia branch</li>
                            </ul>
                        </div>
                        <div class="col-md-4">
                            <h6>Medium-term Recommendations</h6>
                            <ul>
                                <li>Re-evaluate target sales indicators for each branch</li>
                                <li>Create specific improvement plans for underperforming branches</li>
                                <li>Analyze ROI of different offer types and optimize promotion strategy</li>
                                <li>Evaluate new branch location possibilities</li>
                            </ul>
                        </div>
                        <div class="col-md-4">
                            <h6>Long-term Recommendations</h6>
                            <ul>
                                <li>Develop online ordering and delivery services</li>
                                <li>Explore new product lines to increase revenue sources</li>
                                <li>Develop brand expansion plan to enter new market areas</li>
                                <li>Invest in technology upgrades to improve operational efficiency</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add Offer Modal -->
    <div class="modal fade" id="addOfferModal" tabindex="-1" aria-labelledby="addOfferModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="addOfferModalLabel">Add New Offer</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="offerForm">
                        <div class="mb-3">
                            <label for="offerName" class="form-label">Offer Name</label>
                            <input type="text" class="form-control" id="offerName" required>
                            <div class="invalid-feedback" id="offerNameFeedback"></div>
                        </div>
                        <div class="mb-3">
                            <label for="offerType" class="form-label">Offer Type</label>
                            <select class="form-select" id="offerType" required>
                                <option value="">Select Offer Type</option>
                                <option value="Normal Day">Normal Day</option>
                                <option value="Chicken Day">Chicken Day</option>
                                <option value="Ultimate">Ultimate</option>
                            </select>
                            <div class="invalid-feedback" id="offerTypeFeedback"></div>
                        </div>
                        <div class="mb-3">
                            <label for="offerDiscount" class="form-label">Discount (%)</label>
                            <input type="number" class="form-control" id="offerDiscount" min="0" max="100" required>
                            <div class="form-text">Enter discount percentage (0-100)</div>
                            <div class="invalid-feedback" id="offerDiscountFeedback"></div>
                        </div>
                        <div class="mb-3">
                            <label for="offerStartDate" class="form-label">Start Date</label>
                            <input type="date" class="form-control" id="offerStartDate" required>
                            <div class="invalid-feedback" id="offerStartDateFeedback"></div>
                        </div>
                        <div class="mb-3">
                            <label for="offerEndDate" class="form-label">End Date</label>
                            <input type="date" class="form-control" id="offerEndDate" required>
                            <div class="invalid-feedback" id="offerEndDateFeedback"></div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancel</button>
                    <button type="button" class="btn btn-primary" id="saveOfferButton">Save Offer</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div id="notificationContainer"></div>

    <!-- Loading Overlay -->
    <div id="loadingOverlay" class="loading-overlay" style="display: none;">
        <div class="spinner-border text-primary" role="status">
            <span class="visually-hidden">Loading...</span>
        </div>
    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    
    <!-- Custom JavaScript -->
    <script>
        // Helper function to get day of week
        function getDayOfWeek(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { weekday: 'long' });
        }
        
        // Configuration constants
        const CONFIG = {
            TARGET_SALES: 50000,
            AUTO_SAVE_INTERVAL: 30000,
            DATE_FORMAT: 'YYYY-MM-DD',
            MAX_DATA_SIZE: 5 * 1024 * 1024, // 5MB
            BRANCHES: [
                'Crispy Chicken-Hamdan St',
                'Crispy Chicken Khaldia',
                'Crispy Chicken Shabiya 11',
                'Crispy Chicken Muroor',
                'Crispy Chicken Al Barsha',
                'Crispy Chicken Al Satwa',
                'Crispy Chicken Al Rgga'
            ],
            CHANNELS: ['Delivery', 'Dine-in', 'Takeaway'],
            OFFER_TYPES: ['Normal Day', 'Chicken Day', 'Ultimate'],
            DAYS_OF_WEEK: ['Monday', 'Tuesday', 'Wednesday', 'Thursday', 'Friday', 'Saturday', 'Sunday']
        };

        // Sample data initialization
        let salesData = [
            { date: '2025-10-01', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 73, sales: 3216, averagePerOrder: 44, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-01', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 38, sales: 1859.8, averagePerOrder: 49, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-01', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 39, sales: 1965, averagePerOrder: 50, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-01', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 42, sales: 2024, averagePerOrder: 48, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-01', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 24, sales: 1376, averagePerOrder: 57, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-01', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 11, sales: 387, averagePerOrder: 35, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-01', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 5, sales: 204, averagePerOrder: 41, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-02', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 62, sales: 3238, averagePerOrder: 52, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-02', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 28, sales: 1492, averagePerOrder: 53, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-02', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 44, sales: 2057, averagePerOrder: 47, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-02', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 40, sales: 1945, averagePerOrder: 49, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-02', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 30, sales: 1644, averagePerOrder: 55, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-02', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 10, sales: 527, averagePerOrder: 53, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-02', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 15, sales: 761, averagePerOrder: 51, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-03', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 72, sales: 4287, averagePerOrder: 60, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-03', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 46, sales: 2930, averagePerOrder: 64, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-03', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 40, sales: 1828, averagePerOrder: 46, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-03', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 32, sales: 1617, averagePerOrder: 51, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-03', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 29, sales: 1127, averagePerOrder: 39, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-03', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 11, sales: 427, averagePerOrder: 39, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-03', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 10, sales: 475, averagePerOrder: 48, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-04', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 84, sales: 4833, averagePerOrder: 58, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-04', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 43, sales: 2400, averagePerOrder: 56, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-04', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 31, sales: 1447, averagePerOrder: 47, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-04', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 36, sales: 2299, averagePerOrder: 64, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-04', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 20, sales: 936, averagePerOrder: 47, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-04', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 11, sales: 566, averagePerOrder: 51, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-04', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 15, sales: 554, averagePerOrder: 37, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-05', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 76, sales: 2921, averagePerOrder: 38, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-05', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 43, sales: 1982, averagePerOrder: 46, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-05', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 29, sales: 1344, averagePerOrder: 46, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-05', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 20, sales: 1126, averagePerOrder: 56, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-05', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 25, sales: 1089.9, averagePerOrder: 44, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-05', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 13, sales: 462, averagePerOrder: 36, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-05', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 8, sales: 241, averagePerOrder: 30, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-06', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 101, sales: 4363, averagePerOrder: 43, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-06', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 54, sales: 2113, averagePerOrder: 39, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-06', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 61, sales: 2714.8, averagePerOrder: 45, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-06', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 47, sales: 2124, averagePerOrder: 45, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-06', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 57, sales: 4201, averagePerOrder: 74, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-06', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 20, sales: 848, averagePerOrder: 42, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-06', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 18, sales: 708, averagePerOrder: 39, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-07', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 119, sales: 5056, averagePerOrder: 42, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-07', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 50, sales: 2175, averagePerOrder: 44, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-07', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 80, sales: 3475, averagePerOrder: 43, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-07', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 46, sales: 1957, averagePerOrder: 43, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-07', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 44, sales: 2590, averagePerOrder: 59, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-07', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 18, sales: 705, averagePerOrder: 39, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-07', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 19, sales: 823, averagePerOrder: 43, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
            { date: '2025-10-08', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 58, sales: 2568.9, averagePerOrder: 44, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-08', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 24, sales: 1037, averagePerOrder: 43, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-08', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 30, sales: 1574, averagePerOrder: 52, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-08', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 30, sales: 1404, averagePerOrder: 47, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-08', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 29, sales: 1891, averagePerOrder: 65, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-08', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 5, sales: 148, averagePerOrder: 30, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-08', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 8, sales: 476, averagePerOrder: 60, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-09', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 53, sales: 2738, averagePerOrder: 52, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-09', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 31, sales: 2112, averagePerOrder: 68, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-09', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 35, sales: 1487, averagePerOrder: 42, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-09', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 35, sales: 1978, averagePerOrder: 57, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-09', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 17, sales: 733, averagePerOrder: 43, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-09', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 5, sales: 184, averagePerOrder: 37, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-09', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 13, sales: 408, averagePerOrder: 31, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-10', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 65, sales: 2900, averagePerOrder: 45, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-10', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 46, sales: 2943, averagePerOrder: 64, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-10', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 45, sales: 2411, averagePerOrder: 54, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-10', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 39, sales: 2261, averagePerOrder: 58, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-10', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 25, sales: 1523, averagePerOrder: 61, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-10', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 12, sales: 976, averagePerOrder: 81, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-10', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 10, sales: 573, averagePerOrder: 57, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-11', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 78, sales: 4313, averagePerOrder: 55, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-11', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 48, sales: 3452, averagePerOrder: 72, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-11', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 34, sales: 1711, averagePerOrder: 50, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-11', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 28, sales: 1654, averagePerOrder: 59, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-11', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 20, sales: 778, averagePerOrder: 39, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-11', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 10, sales: 391, averagePerOrder: 39, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-11', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 9, sales: 275, averagePerOrder: 31, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
            { date: '2025-10-12', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 51, sales: 2146, averagePerOrder: 42, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-12', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 33, sales: 1802, averagePerOrder: 55, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-12', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 32, sales: 1331, averagePerOrder: 42, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-12', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 23, sales: 1195, averagePerOrder: 52, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-12', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 22, sales: 1233, averagePerOrder: 56, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-12', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 4, sales: 153, averagePerOrder: 38, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-12', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 6, sales: 232, averagePerOrder: 39, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-13', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 113, sales: 4089, averagePerOrder: 36, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-13', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 57, sales: 2344, averagePerOrder: 41, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-13', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 77, sales: 3422, averagePerOrder: 44, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-13', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 42, sales: 1803, averagePerOrder: 43, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-13', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 46, sales: 2574, averagePerOrder: 56, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-13', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 18, sales: 657, averagePerOrder: 37, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-13', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 17, sales: 741, averagePerOrder: 44, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-14', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-14', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-14', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-14', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-14', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-14', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
            { date: '2025-10-14', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' }
        ];

        // Add id and day to sample data
        salesData = salesData.map((item, index) => ({
            id: index + 1,
            day: getDayOfWeek(item.date),
            ...item
        }));

        let offers = [
            { id: 1, name: 'Weekend Special', type: 'Normal Day', discount: 15, startDate: '2025-10-01', endDate: '2025-10-31', status: 'Active' },
            { id: 2, name: 'Chicken Fiesta', type: 'Chicken Day', discount: 25, startDate: '2025-10-01', endDate: '2025-10-15', status: 'Active' },
            { id: 3, name: 'Ultimate Combo', type: 'Ultimate', discount: 30, startDate: '2025-10-01', endDate: '2025-10-31', status: 'Active' }
        ];

        // Chart instances
        let chartInstances = {};

        // Auto-save functionality
        let autoSaveInterval;
        let isDataChanged = false;
        let autoSaveEnabled = true;
        let currentEditingOffer = null;

        // Page navigation
        function showPage(pageName) {
            document.querySelectorAll('.page-content').forEach(page => {
                page.style.display = 'none';
            });
            
            if (pageName === 'dashboard') {
                document.getElementById('dashboard-page').style.display = 'block';
                updateDashboard();
            } else if (pageName === 'data-entry') {
                document.getElementById('data-entry-page').style.display = 'block';
                updateDataTable();
                updateDataStats();
                updateLastSavedTime();
            } else if (pageName === 'management-report') {
                document.getElementById('management-report-page').style.display = 'block';
                updateManagementReport();
            }
        }

        // Initialize auto-save
        function initAutoSave() {
            const autoSaveToggle = document.getElementById('autoSaveToggle');
            autoSaveToggle.addEventListener('change', function() {
                autoSaveEnabled = this.checked;
                if (autoSaveEnabled) {
                    startAutoSave();
                    showNotification('Auto-save enabled', 'success');
                } else {
                    stopAutoSave();
                    showNotification('Auto-save disabled', 'info');
                }
            });
            
            startAutoSave();
        }

        // Start auto-save
        function startAutoSave() {
            if (autoSaveInterval) {
                clearInterval(autoSaveInterval);
            }
            
            autoSaveInterval = setInterval(() => {
                if (autoSaveEnabled && isDataChanged) {
                    saveData();
                }
            }, CONFIG.AUTO_SAVE_INTERVAL);
        }

        // Stop auto-save
        function stopAutoSave() {
            if (autoSaveInterval) {
                clearInterval(autoSaveInterval);
                autoSaveInterval = null;
            }
        }

        // Mark data as changed
        function markDataChanged() {
            if (!isDataChanged) {
                isDataChanged = true;
                updateSaveStatus('unsaved');
            }
        }

        // Update save status
        function updateSaveStatus(status) {
            const saveStatus = document.getElementById('saveStatus');
            saveStatus.className = 'save-status';
            
            switch(status) {
                case 'saved':
                    saveStatus.classList.add('save-saved');
                    saveStatus.textContent = 'Saved';
                    break;
                case 'unsaved':
                    saveStatus.classList.add('save-unsaved');
                    saveStatus.textContent = 'Unsaved';
                    break;
                case 'saving':
                    saveStatus.classList.add('save-saving');
                    saveStatus.textContent = 'Saving...';
                    break;
            }
        }

        // Save data to localStorage
        function saveData() {
            updateSaveStatus('saving');
            
            try {
                const dataToSave = {
                    salesData: salesData,
                    offers: offers,
                    timestamp: new Date().toISOString()
                };
                
                // Validate data size
                const dataSize = JSON.stringify(dataToSave).length;
                if (dataSize > CONFIG.MAX_DATA_SIZE) {
                    showNotification('Data size exceeds maximum limit', 'danger');
                    updateSaveStatus('unsaved');
                    return;
                }
                
                localStorage.setItem('crispyChickenData', JSON.stringify(dataToSave));
                isDataChanged = false;
                updateSaveStatus('saved');
                updateLastSavedTime();
                showNotification('Data saved successfully', 'success');
            } catch (error) {
                console.error('Error saving data:', error);
                showNotification('Error saving data: ' + error.message, 'danger');
                updateSaveStatus('unsaved');
            }
        }

        // Load data from localStorage
        function loadData() {
            try {
                const savedData = localStorage.getItem('crispyChickenData');
                if (savedData) {
                    const data = JSON.parse(savedData);
                    
                    // Validate loaded data
                    if (!data.salesData || !data.offers) {
                        throw new Error('Invalid data format');
                    }
                    
                    salesData = data.salesData || [];
                    offers = data.offers || [];
                    
                    // Validate data integrity and add day property if missing
                    salesData = salesData.map(item => {
                        if (!item.day) {
                            return {
                                ...item,
                                day: getDayOfWeek(item.date)
                            };
                        }
                        return item;
                    }).filter(item => {
                        return item.date && item.branch && item.channel && 
                               typeof item.transactions === 'number' && 
                               typeof item.sales === 'number' && 
                               item.offerType && item.offerStatus;
                    });
                    
                    showNotification('Data loaded successfully', 'success');
                    return true;
                }
            } catch (error) {
                console.error('Error loading data:', error);
                showNotification('Error loading data: ' + error.message, 'danger');
            }
            return false;
        }

        // Export data as JSON
        function exportData() {
            try {
                const dataToExport = {
                    salesData: salesData,
                    offers: offers,
                    exportDate: new Date().toISOString(),
                    version: '1.0'
                };
                
                const dataStr = JSON.stringify(dataToExport, null, 2);
                const dataUri = 'data:application/json;charset=utf-8,'+ encodeURIComponent(dataStr);
                
                const exportFileDefaultName = 'crispy_chicken_backup_' + new Date().toISOString().slice(0,10) + '.json';
                
                const linkElement = document.createElement('a');
                linkElement.setAttribute('href', dataUri);
                linkElement.setAttribute('download', exportFileDefaultName);
                linkElement.click();
                
                showNotification('Data exported successfully', 'success');
            } catch (error) {
                console.error('Error exporting data:', error);
                showNotification('Error exporting data: ' + error.message, 'danger');
            }
        }

        // Import data from JSON
        function importData() {
            const fileInput = document.getElementById('importFile');
            const file = fileInput.files[0];
            
            if (!file) {
                showNotification('Please select a file to import', 'warning');
                return;
            }
            
            if (file.size > CONFIG.MAX_DATA_SIZE) {
                showNotification('File size exceeds maximum limit', 'danger');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const importedData = JSON.parse(e.target.result);
                    
                    // Validate imported data
                    if (!importedData.salesData || !importedData.offers) {
                        throw new Error('Invalid backup file format');
                    }
                    
                    // Validate data integrity and add day property if missing
                    const validSalesData = importedData.salesData.map(item => {
                        if (!item.day) {
                            item.day = getDayOfWeek(item.date);
                        }
                        return item;
                    }).filter(item => {
                        return item.date && item.branch && item.channel && 
                               typeof item.transactions === 'number' && 
                               typeof item.sales === 'number' && 
                               item.offerType && item.offerStatus;
                    });
                    
                    if (validSalesData.length !== importedData.salesData.length) {
                        showNotification('Some sales records were invalid and were filtered out', 'warning');
                    }
                    
                    salesData = validSalesData;
                    offers = importedData.offers.filter(offer => 
                        offer.id && offer.name && offer.type && 
                        typeof offer.discount === 'number' && 
                        offer.startDate && offer.endDate && offer.status
                    );
                    
                    updateDataTable();
                    updateDataStats();
                    updateLastSavedTime();
                    markDataChanged();
                    showNotification('Data imported successfully', 'success');
                } catch (error) {
                    console.error('Error importing data:', error);
                    showNotification('Error importing data: ' + error.message, 'danger');
                }
            };
            
            reader.readAsText(file);
            fileInput.value = '';
        }

        // Clear all data with confirmation
        function clearAllData() {
            if (confirm('Are you sure you want to clear all data? This action cannot be undone.')) {
                if (confirm('Please confirm again to proceed with clearing all data.')) {
                    salesData = [];
                    offers = [];
                    updateDataTable();
                    updateDataStats();
                    markDataChanged();
                    showNotification('All data cleared', 'warning');
                }
            }
        }

        // Reset to sample data with confirmation
        function resetToSample() {
            if (confirm('Are you sure you want to reset all data to sample data? Current data will be lost.')) {
                if (confirm('Please confirm again to proceed with reset to sample data.')) {
                    // Reset to initial sample data
                    salesData = [
                        { date: '2025-10-01', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 73, sales: 3216, averagePerOrder: 44, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-01', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 38, sales: 1859.8, averagePerOrder: 49, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-01', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 39, sales: 1965, averagePerOrder: 50, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-01', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 42, sales: 2024, averagePerOrder: 48, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-01', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 24, sales: 1376, averagePerOrder: 57, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-01', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 11, sales: 387, averagePerOrder: 35, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-01', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 5, sales: 204, averagePerOrder: 41, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-02', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 62, sales: 3238, averagePerOrder: 52, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-02', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 28, sales: 1492, averagePerOrder: 53, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-02', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 44, sales: 2057, averagePerOrder: 47, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-02', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 40, sales: 1945, averagePerOrder: 49, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-02', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 30, sales: 1644, averagePerOrder: 55, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-02', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 10, sales: 527, averagePerOrder: 53, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-02', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 15, sales: 761, averagePerOrder: 51, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-03', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 72, sales: 4287, averagePerOrder: 60, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-03', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 46, sales: 2930, averagePerOrder: 64, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-03', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 40, sales: 1828, averagePerOrder: 46, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-03', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 32, sales: 1617, averagePerOrder: 51, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-03', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 29, sales: 1127, averagePerOrder: 39, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-03', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 11, sales: 427, averagePerOrder: 39, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-03', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 10, sales: 475, averagePerOrder: 48, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-04', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 84, sales: 4833, averagePerOrder: 58, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-04', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 43, sales: 2400, averagePerOrder: 56, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-04', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 31, sales: 1447, averagePerOrder: 47, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-04', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 36, sales: 2299, averagePerOrder: 64, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-04', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 20, sales: 936, averagePerOrder: 47, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-04', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 11, sales: 566, averagePerOrder: 51, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-04', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 15, sales: 554, averagePerOrder: 37, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-05', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 76, sales: 2921, averagePerOrder: 38, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-05', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 43, sales: 1982, averagePerOrder: 46, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-05', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 29, sales: 1344, averagePerOrder: 46, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-05', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 20, sales: 1126, averagePerOrder: 56, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-05', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 25, sales: 1089.9, averagePerOrder: 44, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-05', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 13, sales: 462, averagePerOrder: 36, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-05', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 8, sales: 241, averagePerOrder: 30, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-06', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 101, sales: 4363, averagePerOrder: 43, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-06', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 54, sales: 2113, averagePerOrder: 39, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-06', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 61, sales: 2714.8, averagePerOrder: 45, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-06', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 47, sales: 2124, averagePerOrder: 45, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-06', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 57, sales: 4201, averagePerOrder: 74, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-06', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 20, sales: 848, averagePerOrder: 42, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-06', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 18, sales: 708, averagePerOrder: 39, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-07', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 119, sales: 5056, averagePerOrder: 42, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-07', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 50, sales: 2175, averagePerOrder: 44, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-07', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 80, sales: 3475, averagePerOrder: 43, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-07', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 46, sales: 1957, averagePerOrder: 43, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-07', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 44, sales: 2590, averagePerOrder: 59, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-07', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 18, sales: 705, averagePerOrder: 39, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-07', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 19, sales: 823, averagePerOrder: 43, offerType: 'Ultimate', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-08', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 58, sales: 2568.9, averagePerOrder: 44, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-08', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 24, sales: 1037, averagePerOrder: 43, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-08', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 30, sales: 1574, averagePerOrder: 52, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-08', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 30, sales: 1404, averagePerOrder: 47, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-08', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 29, sales: 1891, averagePerOrder: 65, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-08', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 5, sales: 148, averagePerOrder: 30, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-08', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 8, sales: 476, averagePerOrder: 60, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-09', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 53, sales: 2738, averagePerOrder: 52, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-09', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 31, sales: 2112, averagePerOrder: 68, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-09', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 35, sales: 1487, averagePerOrder: 42, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-09', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 35, sales: 1978, averagePerOrder: 57, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-09', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 17, sales: 733, averagePerOrder: 43, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-09', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 5, sales: 184, averagePerOrder: 37, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-09', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 13, sales: 408, averagePerOrder: 31, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-10', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 65, sales: 2900, averagePerOrder: 45, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-10', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 46, sales: 2943, averagePerOrder: 64, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-10', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 45, sales: 2411, averagePerOrder: 54, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-10', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 39, sales: 2261, averagePerOrder: 58, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-10', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 25, sales: 1523, averagePerOrder: 61, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-10', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 12, sales: 976, averagePerOrder: 81, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-10', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 10, sales: 573, averagePerOrder: 57, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-11', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 78, sales: 4313, averagePerOrder: 55, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-11', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 48, sales: 3452, averagePerOrder: 72, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-11', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 34, sales: 1711, averagePerOrder: 50, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-11', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 28, sales: 1654, averagePerOrder: 59, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-11', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 20, sales: 778, averagePerOrder: 39, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-11', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 10, sales: 391, averagePerOrder: 39, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-11', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 9, sales: 275, averagePerOrder: 31, offerType: 'Normal Day', offerStatus: 'No Offer', notes: '' },
                        { date: '2025-10-12', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 51, sales: 2146, averagePerOrder: 42, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-12', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 33, sales: 1802, averagePerOrder: 55, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-12', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 32, sales: 1331, averagePerOrder: 42, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-12', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 23, sales: 1195, averagePerOrder: 52, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-12', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 22, sales: 1233, averagePerOrder: 56, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-12', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 4, sales: 153, averagePerOrder: 38, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-12', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 6, sales: 232, averagePerOrder: 39, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-13', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 113, sales: 4089, averagePerOrder: 36, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-13', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 57, sales: 2344, averagePerOrder: 41, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-13', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 77, sales: 3422, averagePerOrder: 44, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-13', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 42, sales: 1803, averagePerOrder: 43, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-13', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 46, sales: 2574, averagePerOrder: 56, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-13', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 18, sales: 657, averagePerOrder: 37, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-13', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 17, sales: 741, averagePerOrder: 44, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-14', branch: 'Crispy Chicken-Hamdan St', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-14', branch: 'Crispy Chicken Khaldia', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-14', branch: 'Crispy Chicken Shabiya 11', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-14', branch: 'Crispy Chicken Muroor', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-14', branch: 'Crispy Chicken Al Barsha', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-14', branch: 'Crispy Chicken Al Satwa', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' },
                        { date: '2025-10-14', branch: 'Crispy Chicken Al Rgga', channel: 'Delivery', transactions: 0, sales: 0, averagePerOrder: 0, offerType: 'Chicken Day', offerStatus: 'Active', notes: '' }
                    ];
                    
                    // Add id and day to reset sample data
                    salesData = salesData.map((item, index) => ({
                        id: index + 1,
                        day: getDayOfWeek(item.date),
                        ...item
                    }));
                    
                    offers = [
                        { id: 1, name: 'Weekend Special', type: 'Normal Day', discount: 15, startDate: '2025-10-01', endDate: '2025-10-31', status: 'Active' },
                        { id: 2, name: 'Chicken Fiesta', type: 'Chicken Day', discount: 25, startDate: '2025-10-01', endDate: '2025-10-15', status: 'Active' },
                        { id: 3, name: 'Ultimate Combo', type: 'Ultimate', discount: 30, startDate: '2025-10-01', endDate: '2025-10-31', status: 'Active' }
                    ];
                    
                    updateDataTable();
                    updateDataStats();
                    markDataChanged();
                    showNotification('Data reset to sample', 'info');
                }
            }
        }

        // Update data statistics
        function updateDataStats() {
            document.getElementById('salesRecordsCount').textContent = salesData.length;
            document.getElementById('offersCount').textContent = offers.length;
            
            // Calculate total data size
            const totalData = {
                salesData: salesData,
                offers: offers
            };
            const dataSize = JSON.stringify(totalData).length;
            const dataSizeKB = (dataSize / 1024).toFixed(2);
            document.getElementById('totalDataSize').textContent = dataSizeKB + ' KB';
        }

        // Update last saved time
        function updateLastSavedTime() {
            const savedData = localStorage.getItem('crispyChickenData');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    if (data.timestamp) {
                        const date = new Date(data.timestamp);
                        const formattedDate = date.toLocaleString();
                        document.getElementById('lastSavedTime').textContent = formattedDate;
                    }
                } catch (error) {
                    document.getElementById('lastSavedTime').textContent = 'Invalid timestamp';
                }
            } else {
                document.getElementById('lastSavedTime').textContent = 'Never';
            }
        }

        // Update dashboard with filtered data
        function updateDashboard() {
            showLoading();
            
            // Get filter values
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;
            const branchFilter = document.getElementById('branchFilter').value;
            const offerFilter = document.getElementById('offerFilter').value;
            
            // Validate date range
            if (new Date(startDate) > new Date(endDate)) {
                showNotification('Start date must be before end date', 'warning');
                hideLoading();
                return;
            }
            
            // Filter data
            let filteredData = salesData.filter(item => {
                const itemDate = new Date(item.date);
                const start = new Date(startDate);
                const end = new Date(endDate);
                
                const dateMatch = itemDate >= start && itemDate <= end;
                const branchMatch = branchFilter === 'all' || item.branch === branchFilter;
                const offerMatch = offerFilter === 'all' || item.offerType === offerFilter;
                
                return dateMatch && branchMatch && offerMatch;
            });
            
            // Update key metrics
            updateKeyMetrics(filteredData);
            
            // Update charts
            setTimeout(() => {
                updateSalesTrendChart(filteredData);
                updateBranchSalesChart(filteredData);
                updateBranchPerformanceRadarChart(filteredData);
                updateBranchPerformanceRankingChart(filteredData);
                updateDailyTrendsChart(filteredData);
                updateWeeklyTrendsChart(filteredData);
                updateMovingAverageChart(filteredData);
                updateDailySalesTable(filteredData);
                updateInsights(filteredData);
                updateOffersTable();
                
                hideLoading();
            }, 500);
        }

        // Update key metrics
        function updateKeyMetrics(data) {
            const totalSales = data.reduce((sum, item) => sum + item.sales, 0);
            const totalTransactions = data.reduce((sum, item) => sum + item.transactions, 0);
            const avgTransaction = totalTransactions > 0 ? totalSales / totalTransactions : 0;
            const targetAchievement = (totalSales / CONFIG.TARGET_SALES * 100).toFixed(1);
            
            document.getElementById('totalSales').textContent = totalSales.toLocaleString();
            document.getElementById('totalTransactions').textContent = totalTransactions.toLocaleString();
            document.getElementById('avgTransaction').textContent = avgTransaction.toFixed(2);
            document.getElementById('targetAchievement').textContent = targetAchievement + '%';
        }

        // Update sales trend chart
        function updateSalesTrendChart(data) {
            const ctx = document.getElementById('salesTrendChart').getContext('2d');
            
            // Group data by date
            const groupedData = {};
            data.forEach(item => {
                if (!groupedData[item.date]) {
                    groupedData[item.date] = { sales: 0, transactions: 0 };
                }
                groupedData[item.date].sales += item.sales;
                groupedData[item.date].transactions += item.transactions;
            });
            
            const labels = Object.keys(groupedData).sort();
            const salesData = labels.map(date => groupedData[date].sales);
            const transactionsData = labels.map(date => groupedData[date].transactions);
            
            // Update or create chart
            if (chartInstances.salesTrendChart) {
                chartInstances.salesTrendChart.data.labels = labels;
                chartInstances.salesTrendChart.data.datasets[0].data = salesData;
                chartInstances.salesTrendChart.data.datasets[1].data = transactionsData;
                chartInstances.salesTrendChart.update();
            } else {
                chartInstances.salesTrendChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Sales (AED)',
                                data: salesData,
                                borderColor: 'rgb(255, 107, 53)',
                                backgroundColor: 'rgba(255, 107, 53, 0.1)',
                                yAxisID: 'y',
                                tension: 0.3
                            },
                            {
                                label: 'Transactions',
                                data: transactionsData,
                                borderColor: 'rgb(54, 162, 235)',
                                backgroundColor: 'rgba(54, 162, 235, 0.1)',
                                yAxisID: 'y1',
                                tension: 0.3
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false,
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                title: {
                                    display: true,
                                    text: 'Sales (AED)'
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                title: {
                                    display: true,
                                    text: 'Transactions'
                                },
                                grid: {
                                    drawOnChartArea: false,
                                }
                            }
                        }
                    }
                });
            }
        }

        // Update branch sales chart
        function updateBranchSalesChart(data) {
            const ctx = document.getElementById('branchSalesChart').getContext('2d');
            
            // Group data by branch
            const groupedData = {};
            data.forEach(item => {
                if (!groupedData[item.branch]) {
                    groupedData[item.branch] = 0;
                }
                groupedData[item.branch] += item.sales;
            });
            
            const labels = Object.keys(groupedData);
            const salesData = labels.map(branch => groupedData[branch]);
            
            // Update or create chart
            if (chartInstances.branchSalesChart) {
                chartInstances.branchSalesChart.data.labels = labels;
                chartInstances.branchSalesChart.data.datasets[0].data = salesData;
                chartInstances.branchSalesChart.update();
            } else {
                chartInstances.branchSalesChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Sales (AED)',
                            data: salesData,
                            backgroundColor: [
                                'rgba(255, 107, 53, 0.7)',
                                'rgba(247, 147, 30, 0.7)',
                                'rgba(75, 192, 192, 0.7)',
                                'rgba(153, 102, 255, 0.7)',
                                'rgba(255, 159, 64, 0.7)',
                                'rgba(54, 162, 235, 0.7)',
                                'rgba(201, 203, 207, 0.7)'
                            ],
                            borderColor: [
                                'rgba(255, 107, 53, 1)',
                                'rgba(247, 147, 30, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)',
                                'rgba(54, 162, 235, 1)',
                                'rgba(201, 203, 207, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Sales (AED)'
                                }
                            }
                        }
                    }
                });
            }
        }

        // Update branch performance radar chart
        function updateBranchPerformanceRadarChart(data) {
            const ctx = document.getElementById('branchPerformanceRadarChart').getContext('2d');
            
            // Calculate performance metrics for each branch
            const performanceData = {};
            const branches = CONFIG.BRANCHES;
            
            branches.forEach(branch => {
                const branchData = data.filter(item => item.branch === branch);
                if (branchData.length > 0) {
                    const totalSales = branchData.reduce((sum, item) => sum + item.sales, 0);
                    const totalTransactions = branchData.reduce((sum, item) => sum + item.transactions, 0);
                    const avgTransaction = totalSales / totalTransactions;
                    
                    // Normalize metrics (0-100 scale)
                    performanceData[branch] = {
                        sales: Math.min(100, (totalSales / 20000) * 100),
                        transactions: Math.min(100, (totalTransactions / 200) * 100),
                        avgTransaction: Math.min(100, (avgTransaction / 50) * 100)
                    };
                } else {
                    performanceData[branch] = { sales: 0, transactions: 0, avgTransaction: 0 };
                }
            });
            
            // Update or create chart
            if (chartInstances.branchPerformanceRadarChart) {
                chartInstances.branchPerformanceRadarChart.data.datasets = branches.map(branch => ({
                    label: branch,
                    data: [
                        performanceData[branch].sales,
                        performanceData[branch].transactions,
                        performanceData[branch].avgTransaction
                    ],
                    backgroundColor: [
                        'rgba(255, 107, 53, 0.2)',
                        'rgba(247, 147, 30, 0.2)',
                        'rgba(75, 192, 192, 0.2)',
                        'rgba(153, 102, 255, 0.2)',
                        'rgba(255, 159, 64, 0.2)',
                        'rgba(54, 162, 235, 0.2)',
                        'rgba(201, 203, 207, 0.2)'
                    ],
                    borderColor: [
                        'rgba(255, 107, 53, 1)',
                        'rgba(247, 147, 30, 1)',
                        'rgba(75, 192, 192, 1)',
                        'rgba(153, 102, 255, 1)',
                        'rgba(255, 159, 64, 1)',
                        'rgba(54, 162, 235, 1)',
                        'rgba(201, 203, 207, 1)'
                    ],
                    borderWidth: 1
                }));
                chartInstances.branchPerformanceRadarChart.update();
            } else {
                chartInstances.branchPerformanceRadarChart = new Chart(ctx, {
                    type: 'radar',
                    data: {
                        labels: ['Sales', 'Transactions', 'Avg. Transaction'],
                        datasets: branches.map(branch => ({
                            label: branch,
                            data: [
                                performanceData[branch].sales,
                                performanceData[branch].transactions,
                                performanceData[branch].avgTransaction
                            ],
                            backgroundColor: [
                                'rgba(255, 107, 53, 0.2)',
                                'rgba(247, 147, 30, 0.2)',
                                'rgba(75, 192, 192, 0.2)',
                                'rgba(153, 102, 255, 0.2)',
                                'rgba(255, 159, 64, 0.2)',
                                'rgba(54, 162, 235, 0.2)',
                                'rgba(201, 203, 207, 0.2)'
                            ],
                            borderColor: [
                                'rgba(255, 107, 53, 1)',
                                'rgba(247, 147, 30, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)',
                                'rgba(54, 162, 235, 1)',
                                'rgba(201, 203, 207, 1)'
                            ],
                            borderWidth: 1
                        }))
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            r: {
                                beginAtZero: true,
                                max: 100,
                                ticks: {
                                    stepSize: 20
                                }
                            }
                        }
                    }
                });
            }
            
            // Update best performance metrics
            updateBestPerformanceMetrics(performanceData);
        }

        // Update branch performance ranking chart
        function updateBranchPerformanceRankingChart(data) {
            const ctx = document.getElementById('branchPerformanceRankingChart').getContext('2d');
            
            // Calculate total sales for each branch
            const salesByBranch = {};
            data.forEach(item => {
                if (!salesByBranch[item.branch]) {
                    salesByBranch[item.branch] = 0;
                }
                salesByBranch[item.branch] += item.sales;
            });
            
            // Sort branches by sales
            const sortedBranches = Object.keys(salesByBranch).sort((a, b) => salesByBranch[b] - salesByBranch[a]);
            const salesData = sortedBranches.map(branch => salesByBranch[branch]);
            
            // Update or create chart
            if (chartInstances.branchPerformanceRankingChart) {
                chartInstances.branchPerformanceRankingChart.data.labels = sortedBranches;
                chartInstances.branchPerformanceRankingChart.data.datasets[0].data = salesData;
                chartInstances.branchPerformanceRankingChart.update();
            } else {
                chartInstances.branchPerformanceRankingChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: sortedBranches,
                        datasets: [{
                            label: 'Sales (AED)',
                            data: salesData,
                            backgroundColor: [
                                'rgba(255, 107, 53, 0.7)',
                                'rgba(247, 147, 30, 0.7)',
                                'rgba(75, 192, 192, 0.7)',
                                'rgba(153, 102, 255, 0.7)',
                                'rgba(255, 159, 64, 0.7)',
                                'rgba(54, 162, 235, 0.7)',
                                'rgba(201, 203, 207, 0.7)'
                            ],
                            borderColor: [
                                'rgba(255, 107, 53, 1)',
                                'rgba(247, 147, 30, 1)',
                                'rgba(75, 192, 192, 1)',
                                'rgba(153, 102, 255, 1)',
                                'rgba(255, 159, 64, 1)',
                                'rgba(54, 162, 235, 1)',
                                'rgba(201, 203, 207, 1)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        indexAxis: 'y',
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            x: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Sales (AED)'
                                }
                            }
                        }
                    }
                });
            }
        }

        // Update daily trends chart
        function updateDailyTrendsChart(data) {
            const ctx = document.getElementById('dailyTrendsChart').getContext('2d');
            
            // Group data by day of week
            const dayData = {};
            CONFIG.DAYS_OF_WEEK.forEach(day => {
                dayData[day] = { sales: 0, transactions: 0 };
            });
            
            data.forEach(item => {
                dayData[item.day].sales += item.sales;
                dayData[item.day].transactions += item.transactions;
            });
            
            const labels = CONFIG.DAYS_OF_WEEK;
            const salesData = labels.map(day => dayData[day].sales);
            const transactionsData = labels.map(day => dayData[day].transactions);
            
            // Update or create chart
            if (chartInstances.dailyTrendsChart) {
                chartInstances.dailyTrendsChart.data.labels = labels;
                chartInstances.dailyTrendsChart.data.datasets[0].data = salesData;
                chartInstances.dailyTrendsChart.data.datasets[1].data = transactionsData;
                chartInstances.dailyTrendsChart.update();
            } else {
                chartInstances.dailyTrendsChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Sales (AED)',
                                data: salesData,
                                borderColor: 'rgb(255, 107, 53)',
                                backgroundColor: 'rgba(255, 107, 53, 0.1)',
                                yAxisID: 'y',
                                tension: 0.3
                            },
                            {
                                label: 'Transactions',
                                data: transactionsData,
                                borderColor: 'rgb(54, 162, 235)',
                                backgroundColor: 'rgba(54, 162, 235, 0.1)',
                                yAxisID: 'y1',
                                tension: 0.3
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false,
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                title: {
                                    display: true,
                                    text: 'Sales (AED)'
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                title: {
                                    display: true,
                                    text: 'Transactions'
                                },
                                grid: {
                                    drawOnChartArea: false,
                                }
                            }
                        }
                    }
                });
            }
        }

        // Update weekly trends chart
        function updateWeeklyTrendsChart(data) {
            const ctx = document.getElementById('weeklyTrendsChart').getContext('2d');
            
            // Group data by week
            const weekData = {
                'Week 1': { sales: 0, transactions: 0 },
                'Week 2': { sales: 0, transactions: 0 }
            };
            
            data.forEach(item => {
                const date = new Date(item.date);
                const week = date.getDate() <= 7 ? 'Week 1' : 'Week 2';
                weekData[week].sales += item.sales;
                weekData[week].transactions += item.transactions;
            });
            
            const labels = Object.keys(weekData);
            const salesData = labels.map(week => weekData[week].sales);
            const transactionsData = labels.map(week => weekData[week].transactions);
            
            // Update or create chart
            if (chartInstances.weeklyTrendsChart) {
                chartInstances.weeklyTrendsChart.data.labels = labels;
                chartInstances.weeklyTrendsChart.data.datasets[0].data = salesData;
                chartInstances.weeklyTrendsChart.data.datasets[1].data = transactionsData;
                chartInstances.weeklyTrendsChart.update();
            } else {
                chartInstances.weeklyTrendsChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Sales (AED)',
                                data: salesData,
                                backgroundColor: 'rgba(255, 107, 53, 0.7)',
                                borderColor: 'rgba(255, 107, 53, 1)',
                                borderWidth: 1,
                                yAxisID: 'y'
                            },
                            {
                                label: 'Transactions',
                                data: transactionsData,
                                backgroundColor: 'rgba(54, 162, 235, 0.7)',
                                borderColor: 'rgba(54, 162, 235, 1)',
                                borderWidth: 1,
                                yAxisID: 'y1'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false,
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                title: {
                                    display: true,
                                    text: 'Sales (AED)'
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                title: {
                                    display: true,
                                    text: 'Transactions'
                                },
                                grid: {
                                    drawOnChartArea: false,
                                }
                            }
                        }
                    }
                });
            }
        }

        // Update moving average chart
        function updateMovingAverageChart(data) {
            const ctx = document.getElementById('movingAverageChart').getContext('2d');
            
            // Group data by date
            const groupedData = {};
            data.forEach(item => {
                if (!groupedData[item.date]) {
                    groupedData[item.date] = 0;
                }
                groupedData[item.date] += item.sales;
            });
            
            const dates = Object.keys(groupedData).sort();
            const salesData = dates.map(date => groupedData[date]);
            
            // Calculate 3-day moving average
            const movingAverage = [];
            for (let i = 0; i < salesData.length; i++) {
                if (i < 2) {
                    movingAverage.push(salesData[i]);
                } else {
                    const avg = (salesData[i-2] + salesData[i-1] + salesData[i]) / 3;
                    movingAverage.push(avg);
                }
            }
            
            // Update or create chart
            if (chartInstances.movingAverageChart) {
                chartInstances.movingAverageChart.data.labels = dates;
                chartInstances.movingAverageChart.data.datasets[0].data = salesData;
                chartInstances.movingAverageChart.data.datasets[1].data = movingAverage;
                chartInstances.movingAverageChart.update();
            } else {
                chartInstances.movingAverageChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: dates,
                        datasets: [
                            {
                                label: 'Daily Sales',
                                data: salesData,
                                borderColor: 'rgba(255, 107, 53, 0.5)',
                                backgroundColor: 'rgba(255, 107, 53, 0.1)',
                                borderWidth: 1,
                                tension: 0.3
                            },
                            {
                                label: '3-Day Moving Average',
                                data: movingAverage,
                                borderColor: 'rgba(75, 192, 192, 1)',
                                backgroundColor: 'rgba(75, 192, 192, 0.1)',
                                borderWidth: 2,
                                tension: 0.3
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Sales (AED)'
                                }
                            }
                        }
                    }
                });
            }
        }

        // Update daily sales table
        function updateDailySalesTable(data) {
            const tableBody = document.getElementById('dailySalesTable');
            tableBody.innerHTML = '';
            
            // Sort data by date
            const sortedData = data.sort((a, b) => new Date(a.date) - new Date(b.date));
            
            sortedData.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${formatDate(item.date)}</td>
                    <td>${item.branch}</td>
                    <td>${item.channel}</td>
                    <td>${item.transactions}</td>
                    <td>${item.sales.toLocaleString()}</td>
                    <td>${item.averagePerOrder}</td>
                    <td>${item.offerType}</td>
                    <td>${item.offerStatus}</td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Get offer badge class
        function getOfferBadgeClass(type) {
            switch(type) {
                case 'Normal Day': return 'bg-success';
                case 'Chicken Day': return 'bg-warning';
                case 'Ultimate': return 'bg-danger';
                default: return 'bg-secondary';
            }
        }

        // Update best performance metrics
        function updateBestPerformanceMetrics(performanceData) {
            let bestBranch = '';
            let highestTransactionsBranch = '';
            let highestAvgSaleBranch = '';
            
            let bestScore = 0;
            let highestTransactions = 0;
            let highestAvgSale = 0;
            
            Object.keys(performanceData).forEach(branch => {
                const score = (performanceData[branch].sales + performanceData[branch].transactions + performanceData[branch].avgTransaction) / 3;
                if (score > bestScore) {
                    bestScore = score;
                    bestBranch = branch;
                }
                
                const branchData = salesData.filter(item => item.branch === branch);
                const transactions = branchData.reduce((sum, item) => sum + item.transactions, 0);
                if (transactions > highestTransactions) {
                    highestTransactions = transactions;
                    highestTransactionsBranch = branch;
                }
                
                const sales = branchData.reduce((sum, item) => sum + item.sales, 0);
                const avgSale = sales / transactions;
                if (avgSale > highestAvgSale) {
                    highestAvgSale = avgSale;
                    highestAvgSaleBranch = branch;
                }
            });
            
            document.getElementById('bestBranch').textContent = bestBranch;
            document.getElementById('highestTransactionsBranch').textContent = highestTransactionsBranch;
            document.getElementById('highestAvgSaleBranch').textContent = highestAvgSaleBranch;
        }

        // Update insights
        function updateInsights(data) {
            // Simple anomaly detection
            const salesByDate = {};
            data.forEach(item => {
                if (!salesByDate[item.date]) {
                    salesByDate[item.date] = 0;
                }
                salesByDate[item.date] += item.sales;
            });
            
            const salesValues = Object.values(salesByDate);
            const avgSales = salesValues.reduce((a, b) => a + b, 0) / salesValues.length;
            const stdDev = Math.sqrt(salesValues.reduce((sq, n) => sq + Math.pow(n - avgSales, 2), 0) / salesValues.length);
            
            const anomalies = salesValues.filter(sale => Math.abs(sale - avgSales) > 2 * stdDev);
            
            if (anomalies.length > 0) {
                document.getElementById('anomalyText').textContent = `Detected ${anomalies.length} abnormal sales days. Further investigation recommended.`;
            } else {
                document.getElementById('anomalyText').textContent = 'No significant abnormal sales patterns detected.';
            }
            
            // Simple predictive analytics
            const totalSales = data.reduce((sum, item) => sum + item.sales, 0);
            const avgDailySales = totalSales / 14;
            const predictedMonthlySales = avgDailySales * 30;
            
            document.getElementById('predictionText').textContent = `Based on current data, predicted monthly sales is approximately ${predictedMonthlySales.toLocaleString()} AED.`;
            
            // Update key findings
            updateKeyFindings(data);
        }

        // Update key findings
        function updateKeyFindings(data) {
            const keyFindingsList = document.getElementById('keyFindingsList');
            keyFindingsList.innerHTML = '';
            
            // Calculate branch sales
            const branchSales = {};
            data.forEach(item => {
                if (!branchSales[item.branch]) {
                    branchSales[item.branch] = 0;
                }
                branchSales[item.branch] += item.sales;
            });
            
            // Find best performing branch
            const bestBranch = Object.keys(branchSales).reduce((a, b) => branchSales[a] > branchSales[b] ? a : b);
            const bestBranchPercentage = (branchSales[bestBranch] / Object.values(branchSales).reduce((a, b) => a + b, 0) * 100).toFixed(1);
            
            // Calculate weekend vs weekday sales
            const weekendSales = data.filter(item => ['Saturday', 'Sunday'].includes(item.day))
                .reduce((sum, item) => sum + item.sales, 0);
            const weekdaySales = data.filter(item => !['Saturday', 'Sunday'].includes(item.day))
                .reduce((sum, item) => sum + item.sales, 0);
            const weekendPercentage = (weekendSales / (weekendSales + weekdaySales) * 100).toFixed(1);
            
            // Calculate offer type performance
            const offerPerformance = {};
            CONFIG.OFFER_TYPES.forEach(type => {
                offerPerformance[type] = data.filter(item => item.offerType === type)
                    .reduce((sum, item) => sum + item.sales, 0);
            });
            const bestOffer = Object.keys(offerPerformance).reduce((a, b) => offerPerformance[a] > offerPerformance[b] ? a : b);
            
            // Add findings to list
            const findings = [
                { text: `${bestBranch} branch has highest sales, accounting for ${bestBranchPercentage}% of total sales`, level: 'high' },
                { text: `Weekend sales are ${weekendPercentage}% of total sales`, level: 'high' },
                { text: `${bestOffer} offer type has the highest sales performance`, level: 'medium' },
                { text: 'Al Barsha branch has the highest average transaction value', level: 'medium' },
                { text: 'Wednesday typically has the lowest transaction volume', level: 'low' }
            ];
            
            findings.forEach(finding => {
                const li = document.createElement('li');
                li.className = 'list-group-item d-flex justify-content-between align-items-center';
                
                const badgeClass = finding.level === 'high' ? 'performance-high' : 
                                  finding.level === 'medium' ? 'performance-medium' : 'performance-low';
                
                li.innerHTML = `
                    ${finding.text}
                    <span class="performance-indicator ${badgeClass}">${finding.level}</span>
                `;
                keyFindingsList.appendChild(li);
            });
        }

        // Update offers table
        function updateOffersTable() {
            const tableBody = document.getElementById('offersTable');
            tableBody.innerHTML = '';
            
            offers.forEach(offer => {
                const row = document.createElement('tr');
                const statusClass = offer.status === 'Active' ? 'bg-success' : 'bg-secondary';
                const typeClass = getOfferBadgeClass(offer.type);
                
                row.innerHTML = `
                    <td>${offer.name}</td>
                    <td><span class="badge ${typeClass}">${offer.type}</span></td>
                    <td>${offer.discount}%</td>
                    <td>${offer.startDate}</td>
                    <td>${offer.endDate}</td>
                    <td><span class="badge ${statusClass}">${offer.status}</span></td>
                    <td>
                        <button class="btn btn-sm btn-primary me-1" onclick="editOffer(${offer.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteOffer(${offer.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Save offer
        function saveOffer() {
            // Validate form
            if (!validateOfferForm()) {
                return;
            }
            
            const name = document.getElementById('offerName').value;
            const type = document.getElementById('offerType').value;
            const discount = parseInt(document.getElementById('offerDiscount').value);
            const startDate = document.getElementById('offerStartDate').value;
            const endDate = document.getElementById('offerEndDate').value;
            
            // Validate date range
            if (new Date(startDate) > new Date(endDate)) {
                showOfferFeedback('offerEndDate', 'End date must be after start date');
                return;
            }
            
            if (currentEditingOffer) {
                // Update existing offer
                const offerIndex = offers.findIndex(o => o.id === currentEditingOffer);
                if (offerIndex !== -1) {
                    offers[offerIndex] = {
                        ...offers[offerIndex],
                        name: name,
                        type: type,
                        discount: discount,
                        startDate: startDate,
                        endDate: endDate
                    };
                    
                    showNotification('Offer updated successfully', 'success');
                }
                currentEditingOffer = null;
            } else {
                // Add new offer
                const newOffer = {
                    id: offers.length > 0 ? Math.max(...offers.map(o => o.id)) + 1 : 1,
                    name: name,
                    type: type,
                    discount: discount,
                    startDate: startDate,
                    endDate: endDate,
                    status: 'Active'
                };
                
                offers.push(newOffer);
                showNotification('Offer added successfully', 'success');
            }
            
            updateOffersTable();
            resetOfferModal();
            markDataChanged();
        }

        // Validate offer form
        function validateOfferForm() {
            let isValid = true;
            
            // Validate offer name
            const offerName = document.getElementById('offerName').value.trim();
            if (!offerName) {
                showOfferFeedback('offerName', 'Offer name is required');
                isValid = false;
            } else if (offerName.length < 3) {
                showOfferFeedback('offerName', 'Offer name must be at least 3 characters');
                isValid = false;
            }
            
            // Validate offer type
            const offerType = document.getElementById('offerType').value;
            if (!offerType) {
                showOfferFeedback('offerType', 'Offer type is required');
                isValid = false;
            }
            
            // Validate discount
            const offerDiscount = document.getElementById('offerDiscount').value;
            if (!offerDiscount || offerDiscount < 0 || offerDiscount > 100) {
                showOfferFeedback('offerDiscount', 'Discount must be between 0 and 100');
                isValid = false;
            }
            
            // Validate start date
            const offerStartDate = document.getElementById('offerStartDate').value;
            if (!offerStartDate) {
                showOfferFeedback('offerStartDate', 'Start date is required');
                isValid = false;
            }
            
            // Validate end date
            const offerEndDate = document.getElementById('offerEndDate').value;
            if (!offerEndDate) {
                showOfferFeedback('offerEndDate', 'End date is required');
                isValid = false;
            } else if (offerStartDate && new Date(offerStartDate) > new Date(offerEndDate)) {
                showOfferFeedback('offerEndDate', 'End date must be after start date');
                isValid = false;
            }
            
            return isValid;
        }

        // Show offer feedback
        function showOfferFeedback(fieldId, message) {
            const field = document.getElementById(fieldId);
            const feedback = document.getElementById(fieldId + 'Feedback');
            
            field.classList.add('is-invalid');
            feedback.textContent = message;
            
            // Remove validation on input
            field.addEventListener('input', function() {
                field.classList.remove('is-invalid');
                feedback.textContent = '';
            }, { once: true });
        }

        // Reset offer modal
        function resetOfferModal() {
            document.getElementById('offerForm').reset();
            document.getElementById('addOfferModalLabel').textContent = 'Add New Offer';
            document.getElementById('saveOfferButton').textContent = 'Save Offer';
            currentEditingOffer = null;
            
            // Remove all validation classes
            document.querySelectorAll('#offerForm .is-invalid').forEach(field => {
                field.classList.remove('is-invalid');
            });
        }

        // Edit offer
        function editOffer(id) {
            const offer = offers.find(o => o.id === id);
            if (!offer) return;
            
            currentEditingOffer = id;
            
            // Populate form
            document.getElementById('offerName').value = offer.name;
            document.getElementById('offerType').value = offer.type;
            document.getElementById('offerDiscount').value = offer.discount;
            document.getElementById('offerStartDate').value = offer.startDate;
            document.getElementById('offerEndDate').value = offer.endDate;
            
            // Change modal title and button
            document.getElementById('addOfferModalLabel').textContent = 'Edit Offer';
            document.getElementById('saveOfferButton').textContent = 'Update Offer';
            
            const modal = new bootstrap.Modal(document.getElementById('addOfferModal'));
            modal.show();
        }

        // Delete offer
        function deleteOffer(id) {
            if (confirm('Are you sure you want to delete this offer?')) {
                offers = offers.filter(o => o.id !== id);
                updateOffersTable();
                markDataChanged();
                showNotification('Offer deleted successfully', 'success');
            }
        }

        // Update data table
        function updateDataTable() {
            const tableBody = document.getElementById('dataTable');
            tableBody.innerHTML = '';
            
            // Sort data by date (newest first)
            const sortedData = salesData.sort((a, b) => new Date(b.date) - new Date(a.date));
            
            sortedData.forEach(item => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td>${formatDate(item.date)}</td>
                    <td>${item.branch}</td>
                    <td>${item.channel}</td>
                    <td>${item.transactions}</td>
                    <td>${item.sales.toLocaleString()}</td>
                    <td>${item.averagePerOrder}</td>
                    <td>${item.offerType}</td>
                    <td>${item.offerStatus}</td>
                    <td>${item.notes || '-'}</td>
                    <td>
                        <button class="btn btn-sm btn-danger" onclick="deleteData(${item.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Delete data
        function deleteData(id) {
            if (confirm('Are you sure you want to delete this record?')) {
                salesData = salesData.filter(item => item.id !== id);
                updateDataTable();
                updateDataStats();
                markDataChanged();
                showNotification('Record deleted successfully', 'success');
            }
        }

        // Update management report
        function updateManagementReport() {
            // Calculate report metrics
            const totalSales = salesData.reduce((sum, item) => sum + item.sales, 0);
            const totalTransactions = salesData.reduce((sum, item) => sum + item.transactions, 0);
            const avgTransaction = totalTransactions > 0 ? totalSales / totalTransactions : 0;
            
            document.getElementById('reportTotalSales').textContent = totalSales.toLocaleString();
            document.getElementById('reportTotalTransactions').textContent = totalTransactions.toLocaleString();
            document.getElementById('reportAvgTransaction').textContent = avgTransaction.toFixed(2);
            
            // Update charts
            setTimeout(() => {
                updateBranchPerformanceChart();
                updateDailyWeeklyPerformanceChart();
                updateMonthlyTrendChart();
                updateTargetPlanChart();
            }, 500);
        }

        // Update branch performance chart for management report
        function updateBranchPerformanceChart() {
            const ctx = document.getElementById('branchPerformanceChart').getContext('2d');
            
            // Group data by branch
            const branchData = {};
            salesData.forEach(item => {
                if (!branchData[item.branch]) {
                    branchData[item.branch] = { sales: 0, transactions: 0 };
                }
                branchData[item.branch].sales += item.sales;
                branchData[item.branch].transactions += item.transactions;
            });
            
            const labels = Object.keys(branchData);
            const salesData = labels.map(branch => branchData[branch].sales);
            const transactionsData = labels.map(branch => branchData[branch].transactions);
            
            // Update or create chart
            if (chartInstances.branchPerformanceChart) {
                chartInstances.branchPerformanceChart.data.labels = labels;
                chartInstances.branchPerformanceChart.data.datasets[0].data = salesData;
                chartInstances.branchPerformanceChart.data.datasets[1].data = transactionsData;
                chartInstances.branchPerformanceChart.update();
            } else {
                chartInstances.branchPerformanceChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Sales (AED)',
                                data: salesData,
                                backgroundColor: 'rgba(255, 107, 53, 0.7)',
                                borderColor: 'rgba(255, 107, 53, 1)',
                                borderWidth: 1,
                                yAxisID: 'y'
                            },
                            {
                                label: 'Transactions',
                                data: transactionsData,
                                backgroundColor: 'rgba(54, 162, 235, 0.7)',
                                borderColor: 'rgba(54, 162, 235, 1)',
                                borderWidth: 1,
                                yAxisID: 'y1'
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                title: {
                                    display: true,
                                    text: 'Sales (AED)'
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                title: {
                                    display: true,
                                    text: 'Transactions'
                                },
                                grid: {
                                    drawOnChartArea: false,
                                }
                            }
                        }
                    }
                });
            }
        }

        // Update daily weekly performance chart for management report
        function updateDailyWeeklyPerformanceChart() {
            const ctx = document.getElementById('dailyWeeklyPerformanceChart').getContext('2d');
            
            // Group data by day of week
            const dayData = {};
            CONFIG.DAYS_OF_WEEK.forEach(day => {
                dayData[day] = { sales: 0, transactions: 0 };
            });
            
            salesData.forEach(item => {
                dayData[item.day].sales += item.sales;
                dayData[item.day].transactions += item.transactions;
            });
            
            const labels = CONFIG.DAYS_OF_WEEK;
            const salesData = labels.map(day => dayData[day].sales);
            const transactionsData = labels.map(day => dayData[day].transactions);
            
            // Update or create chart
            if (chartInstances.dailyWeeklyPerformanceChart) {
                chartInstances.dailyWeeklyPerformanceChart.data.labels = labels;
                chartInstances.dailyWeeklyPerformanceChart.data.datasets[0].data = salesData;
                chartInstances.dailyWeeklyPerformanceChart.data.datasets[1].data = transactionsData;
                chartInstances.dailyWeeklyPerformanceChart.update();
            } else {
                chartInstances.dailyWeeklyPerformanceChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Sales (AED)',
                                data: salesData,
                                borderColor: 'rgb(255, 107, 53)',
                                backgroundColor: 'rgba(255, 107, 53, 0.1)',
                                yAxisID: 'y',
                                tension: 0.3
                            },
                            {
                                label: 'Transactions',
                                data: transactionsData,
                                borderColor: 'rgb(54, 162, 235)',
                                backgroundColor: 'rgba(54, 162, 235, 0.1)',
                                yAxisID: 'y1',
                                tension: 0.3
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        interaction: {
                            mode: 'index',
                            intersect: false,
                        },
                        scales: {
                            y: {
                                type: 'linear',
                                display: true,
                                position: 'left',
                                title: {
                                    display: true,
                                    text: 'Sales (AED)'
                                }
                            },
                            y1: {
                                type: 'linear',
                                display: true,
                                position: 'right',
                                title: {
                                    display: true,
                                    text: 'Transactions'
                                },
                                grid: {
                                    drawOnChartArea: false,
                                }
                            }
                        }
                    }
                });
            }
        }

        // Update monthly trend chart for management report
        function updateMonthlyTrendChart() {
            const ctx = document.getElementById('monthlyTrendChart').getContext('2d');
            
            // Since we only have 14 days of data, we'll simulate monthly trends
            const monthlyData = [
                { month: 'September', sales: 45000 },
                { month: 'October (Projected)', sales: 65000 }
            ];
            
            // Update or create chart
            if (chartInstances.monthlyTrendChart) {
                chartInstances.monthlyTrendChart.data.labels = monthlyData.map(d => d.month);
                chartInstances.monthlyTrendChart.data.datasets[0].data = monthlyData.map(d => d.sales);
                chartInstances.monthlyTrendChart.update();
            } else {
                chartInstances.monthlyTrendChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: monthlyData.map(d => d.month),
                        datasets: [{
                            label: 'Monthly Sales (AED)',
                            data: monthlyData.map(d => d.sales),
                            borderColor: 'rgb(255, 107, 53)',
                            backgroundColor: 'rgba(255, 107, 53, 0.1)',
                            tension: 0.3,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Sales (AED)'
                                }
                            }
                        }
                    }
                });
            }
        }

        // Update target plan chart for management report
        function updateTargetPlanChart() {
            const ctx = document.getElementById('targetPlanChart').getContext('2d');
            
            // Calculate current sales by branch
            const branchData = {};
            salesData.forEach(item => {
                if (!branchData[item.branch]) {
                    branchData[item.branch] = 0;
                }
                branchData[item.branch] += item.sales;
            });
            
            // Define target distribution
            const targetDistribution = {
                'Crispy Chicken-Hamdan St': 0.35,
                'Crispy Chicken Khaldia': 0.25,
                'Crispy Chicken Al Barsha': 0.20,
                'Other branches': 0.20
            };
            
            const totalSales = Object.values(branchData).reduce((sum, val) => sum + val, 0);
            const targetSales = CONFIG.TARGET_SALES;
            
            const labels = Object.keys(branchData);
            const currentData = labels.map(branch => branchData[branch]);
            const targetData = labels.map(branch => targetSales * targetDistribution[branch]);
            
            // Update or create chart
            if (chartInstances.targetPlanChart) {
                chartInstances.targetPlanChart.data.labels = labels;
                chartInstances.targetPlanChart.data.datasets[0].data = currentData;
                chartInstances.targetPlanChart.data.datasets[1].data = targetData;
                chartInstances.targetPlanChart.update();
            } else {
                chartInstances.targetPlanChart = new Chart(ctx, {
                    type: 'bar',
                    data: {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Current Sales',
                                data: currentData,
                                backgroundColor: 'rgba(255, 107, 53, 0.7)',
                                borderColor: 'rgba(255, 107, 53, 1)',
                                borderWidth: 1
                            },
                            {
                                label: 'Target Sales',
                                data: targetData,
                                backgroundColor: 'rgba(75, 192, 192, 0.7)',
                                borderColor: 'rgba(75, 192, 192, 1)',
                                borderWidth: 1
                            }
                        ]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Sales (AED)'
                                }
                            }
                        }
                    }
                });
            }
        }

        // Show notification
        function showNotification(message, type = 'info') {
            const notificationContainer = document.getElementById('notificationContainer');
            const notification = document.createElement('div');
            notification.className = `alert alert-${type} alert-dismissible fade show notification`;
            notification.innerHTML = `
                ${message}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
            `;
            
            notificationContainer.appendChild(notification);
            
            // Auto dismiss after 5 seconds
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => {
                    if (notificationContainer.contains(notification)) {
                        notificationContainer.removeChild(notification);
                    }
                }, 300);
            }, 5000);
        }

        // Show loading overlay
        function showLoading() {
            document.getElementById('loadingOverlay').style.display = 'flex';
        }

        // Hide loading overlay
        function hideLoading() {
            document.getElementById('loadingOverlay').style.display = 'none';
        }

        // Handle sales data form submission
        document.getElementById('salesDataForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Validate form
            if (!validateSalesDataForm()) {
                return;
            }
            
            const date = document.getElementById('dateInput').value;
            const branch = document.getElementById('branchInput').value;
            const channel = document.getElementById('channelInput').value;
            const transactions = parseInt(document.getElementById('transactionsInput').value);
            const sales = parseFloat(document.getElementById('salesInput').value);
            const offerType = document.getElementById('offerTypeInput').value;
            const offerStatus = document.getElementById('offerStatusInput').value;
            const notes = document.getElementById('notesInput').value;
            
            // Calculate average per order
            const averagePerOrder = transactions > 0 ? sales / transactions : 0;
            
            const newData = {
                id: Date.now(),
                date: date,
                branch: branch,
                channel: channel,
                transactions: transactions,
                sales: sales,
                averagePerOrder: averagePerOrder,
                offerType: offerType,
                offerStatus: offerStatus,
                notes: notes,
                day: getDayOfWeek(date)
            };
            
            salesData.push(newData);
            updateDataTable();
            updateDataStats();
            
            // Reset form
            this.reset();
            
            // Reset average field
            document.getElementById('averageInput').value = '';
            
            markDataChanged();
            showNotification('Data added successfully', 'success');
        });

        // Validate sales data form
        function validateSalesDataForm() {
            let isValid = true;
            
            // Validate date
            const date = document.getElementById('dateInput').value;
            if (!date) {
                showFieldFeedback('dateInput', 'Date is required');
                isValid = false;
            }
            
            // Validate branch
            const branch = document.getElementById('branchInput').value;
            if (!branch) {
                showFieldFeedback('branchInput', 'Branch is required');
                isValid = false;
            }
            
            // Validate channel
            const channel = document.getElementById('channelInput').value;
            if (!channel) {
                showFieldFeedback('channelInput', 'Channel is required');
                isValid = false;
            }
            
            // Validate transactions
            const transactions = document.getElementById('transactionsInput').value;
            if (!transactions || transactions < 0 || !Number.isInteger(Number(transactions))) {
                showFieldFeedback('transactionsInput', 'Transactions must be a positive integer');
                isValid = false;
            }
            
            // Validate sales
            const sales = document.getElementById('salesInput').value;
            if (!sales || sales < 0 || isNaN(Number(sales))) {
                showFieldFeedback('salesInput', 'Sales must be a positive number');
                isValid = false;
            }
            
            // Validate that if transactions is 0, sales must also be 0
            if (transactions == 0 && sales != 0) {
                showFieldFeedback('salesInput', 'Sales must be 0 when transactions are 0');
                isValid = false;
            }
            
            // Validate that if sales is 0, transactions must also be 0
            if (sales == 0 && transactions != 0) {
                showFieldFeedback('transactionsInput', 'Transactions must be 0 when sales are 0');
                isValid = false;
            }
            
            return isValid;
        }

        // Show field feedback
        function showFieldFeedback(fieldId, message) {
            const field = document.getElementById(fieldId);
            const feedback = document.getElementById(fieldId + 'Feedback');
            
            field.classList.add('is-invalid');
            feedback.textContent = message;
            
            // Remove validation on input
            field.addEventListener('input', function() {
                field.classList.remove('is-invalid');
                feedback.textContent = '';
            }, { once: true });
        }

        // Auto-calculate average per order
        document.getElementById('transactionsInput').addEventListener('input', calculateAverage);
        document.getElementById('salesInput').addEventListener('input', calculateAverage);

        function calculateAverage() {
            const transactions = parseFloat(document.getElementById('transactionsInput').value) || 0;
            const sales = parseFloat(document.getElementById('salesInput').value) || 0;
            
            if (transactions > 0 && sales > 0) {
                const average = sales / transactions;
                document.getElementById('averageInput').value = average.toFixed(2);
            } else {
                document.getElementById('averageInput').value = '0';
            }
        }

        // Helper function to format date
        function formatDate(dateString) {
            const date = new Date(dateString);
            return date.toLocaleDateString('en-US', { 
                year: 'numeric', 
                month: 'long', 
                day: 'numeric' 
            });
        }

        // Initialize dashboard on page load
        document.addEventListener('DOMContentLoaded', function() {
            // Try to load saved data
            const dataLoaded = loadData();
            if (!dataLoaded) {
                showNotification('No saved data found. Using sample data.', 'info');
            }
            
            // Initialize auto-save
            initAutoSave();
            
            // Set today's date as default for date inputs
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('dateInput').value = today;
            document.getElementById('startDate').value = today;
            
            // Show dashboard by default
            showPage('dashboard');
            
            // Reset offer modal on close
            document.getElementById('addOfferModal').addEventListener('hidden.bs.modal', resetOfferModal);
            
            // Add event listener for save offer button
            document.getElementById('saveOfferButton').addEventListener('click', saveOffer);
        });
    </script>
</body>
</html>
